!function c(n,o,i){function s(t,e){if(!o[t]){if(!n[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(a)return a(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=o[t]={exports:{}},n[t][0].call(r.exports,function(e){return s(n[t][1][e]||e)},r,r.exports,c,n,o,i)}return o[t].exports}for(var a="function"==typeof require&&require,e=0;e<i.length;e++)s(i[e]);return s}({1:[function(e,t,r){"use strict";function o(e){const t=Array.from(document.querySelectorAll(rocket_lcp_data.elements)),r=t.map(e=>{var t=e.getBoundingClientRect();return{element:e,rect:t}}).filter(e=>{return 0<e.rect.width&&0<e.rect.height&&(0<=(e=e.rect).bottom&&0<=e.right&&e.top<=(window.innerHeight||document.documentElement.clientHeight)&&e.left<=(window.innerWidth||document.documentElement.clientWidth))}).map(e=>({item:e,area:function(e){var t=Math.min(e.width,(window.innerWidth||document.documentElement.clientWidth)-e.left),e=Math.min(e.height,(window.innerHeight||document.documentElement.clientHeight)-e.top);return t*e}(e.rect),elementInfo:i(e.element)})).sort((e,t)=>t.area-e.area).slice(0,e);return r.map(e=>({element:e.item.element,elementInfo:e.elementInfo}))}function i(e){var t=e.nodeName.toLowerCase();const r={type:"",src:"",srcset:"",sizes:"",sources:[],bg_set:[],current_src:""};if("img"===t&&e.srcset)r.type="img-srcset",r.src=e.src,r.srcset=e.srcset,r.sizes=e.sizes,r.current_src=e.currentSrc;else if("img"===t)r.type="img",r.src=e.src,r.current_src=e.currentSrc;else if("video"===t){r.type="img";var c=e.querySelector("source");r.src=e.poster||(c?c.src:""),r.current_src=r.src}else if("svg"===t){const n=e.querySelector("image");n&&(r.type="img",r.src=n.getAttribute("href")||"",r.current_src=r.src)}else if("picture"===t){r.type="picture";t=e.querySelector("img:not(picture>img)");r.src=t?t.src:"",r.sources=Array.from(e.querySelectorAll("source")).map(e=>({srcset:e.srcset||"",media:e.media||""}))}else{const o=window.getComputedStyle(e,null),i=[o.getPropertyValue("background-image"),getComputedStyle(e,":after").getPropertyValue("background-image"),getComputedStyle(e,":before").getPropertyValue("background-image")],s=i.filter(e=>"none"!==e).join("");if(r.type="bg-img",s.includes("image-set(")&&(r.type="bg-img-set"),!s||""===s)return null;const a=[...s.matchAll(/url\(\s*?['"]?\s*?(\S+?)\s*?["']?\s*?\)\s*?([a-zA-Z0-9\s]*[x|dpcm|dpi|dppx]?)/gi)];r.bg_set=a.map(e=>e[1]?{src:e[1].trim()+(e[2]?" "+e[2].trim():"")}:{}),r.bg_set.every(e=>""===e.src)&&(r.bg_set=a.map(e=>e[1]?{src:e[1].trim()}:{})),0<r.bg_set.length&&(r.src=r.bg_set[0].src,"bg-img-set"===r.type&&(r.src=r.bg_set))}return r}let s=[];function c(){let e=new FormData;if(e.append("action","rocket_check_lcp"),e.append("rocket_lcp_nonce",rocket_lcp_data.nonce),e.append("url",rocket_lcp_data.url),e.append("is_mobile",rocket_lcp_data.is_mobile),!0!==fetch(rocket_lcp_data.ajax_url,{method:"POST",credentials:"same-origin",body:e}).success){var t=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight;if(rocket_lcp_data.is_mobile&&(t>rocket_lcp_data.width_threshold||r>rocket_lcp_data.height_threshold)||!rocket_lcp_data.is_mobile&&(t<rocket_lcp_data.width_threshold||r<rocket_lcp_data.height_threshold))console.log("Bailing out because screen size is not acceptable");else{const c=o(1/0);r=c.find(e=>null!==e.elementInfo);r?s=[{...r.elementInfo,label:"lcp"}]:console.log("No LCP candidate found."),c.forEach(e=>{var{element:t,elementInfo:e}=e;!function(e,t){const r=i(e);if(null===r)return!1;var c="img"===r.type||"img-srcset"===r.type||"video"===r.type,e="bg-img"===r.type||"bg-img-set"===r.type||"picture"===r.type;return(c||e)&&t.some(e=>e.src===r.src)}(t,s)&&s.push({...e,label:"above-the-fold"})});r=JSON.stringify(s);window.performance_images_json=r;rocket_lcp_data.nonce,rocket_lcp_data.url,rocket_lcp_data.is_mobile;const n=new FormData;n.append("action","rocket_lcp"),n.append("rocket_lcp_nonce",rocket_lcp_data.nonce),n.append("url",rocket_lcp_data.url),n.append("is_mobile",rocket_lcp_data.is_mobile),n.append("images",r),n.append("status","success"),fetch(rocket_lcp_data.ajax_url,{method:"POST",credentials:"same-origin",body:n,headers:{"wpr-saas-no-intercept":!0}}).then(e=>e.json()).then(e=>{const t=document.querySelector('[data-name="wpr-lcp-beacon"]');t.setAttribute("beacon-completed","true"),console.log(e)}).catch(e=>{console.error(e)})}}else console.log("Bailing out because data is already available")}"loading"!==document.readyState?(console.time("extract"),setTimeout(c,500),console.timeEnd("extract")):document.addEventListener("DOMContentLoaded",function(){console.time("extract"),setTimeout(c,500),console.timeEnd("extract")})},{}]},{},[1]);
//# sourceMappingURL=lcp-beacon.js.map
